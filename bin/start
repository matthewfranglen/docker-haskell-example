#!/bin/bash

set -euo pipefail

COMMAND=`readlink -f "${0}"`
BIN_DIRECTORY=`dirname "${COMMAND}"`
. "${BIN_DIRECTORY}/lib"

main () {
    check_environment
    build_image
}

check_environment () {
    if no_docker_command
    then
        error_missing_docker
        exit 1
    fi
}

build_image () {
    (
        cd "${ROOT_DIRECTORY}"

        local name=`get_project_name`
        local version=`get_project_version`

        echo "Running ${name}:${version}"

        docker run --detach --name="${name}" "${name}:${version}"
    )
}

main
